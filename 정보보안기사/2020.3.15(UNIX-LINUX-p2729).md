## 2020.3.15(UNIX-LINUX-p27~29)

 ### UNIX/LINUX 기본학습

<hr>

1. Telnet/SSH 클라이언트를 통해 유닉스/리눅스 서버 접속

   a. 사용자 계정명과 패스워드를 입력

2. 사용자 인증을 처리하는 로그인 프로세스가 동작하여 사용자 인증을 처리한다.

   a. /etc/passwd : 사용자 계정 정보를 담고 있는 파일

   b. /etc/shadow : 암호화된 사용자 패스워드를 저장하고 있는 파일

3. 최종적으로 사용자 환경설정 파일을 로드하고, 로그인 쉘을 기동한 후 사용자 홈 디렉토리 에서 사용자 입력을 대기한다.

   a. 쉘(SHELL) : 명령어 해석기, 사용자가 입력한 명령어를 해석해서 커널에 전달하고 커널이 처리한 결과를 사용자에게 출력해주는 역할

   b. 사용자 환경설정 파일(Linux/Bash 쉘 환경)

   ​	i. 모든 사용자에게 적용되는 환경설정 파일 : /etc/profile, /etc/bashrc

   ​	ii. 개별 사용자에게 적용되는 환경설정 파일 : 개별 사용자의 홈디렉토리에 위치한다. (.bash_profile, .bashrc)

<hr>
1.일반적으로 우리가 UNIX/LINUX 서버에 접속하는것은 Telnet이나 SSH 같은 걸 이용해서 접속을 하는거다. telnet은 잘 사용하지 않음 왜냐하면 telnet은 평문 통신을 주로 하기 때문이다.(네트워크 스니핑이 발생했을 때 송수신하는 데이터가 그대로 노출되는 취약점을 가지고 있어서.. 실무에서는 주로 암호화된 통신을 지원하는 SSH서버를 사용한다. )

2.두가지를 기억하고 있어야 한다. /etc/passwd , /etc/shadow 전자는 사용자 계정 정보를 담고 있는 파일이고 후자는 암호화된 사용자 패스워드를 저장하고 있는 파일

3.쉘(SHELL) : 명령어 해석기, 사용자가 입력한 명령어를 해석해서 커널에 전달하고 커널이 처리한 결과를 사용자에게 출력해주는 역할

쉘의 종류는 다양하다. 왜냐하면 처음에 나왔을때보다 더 발전했기 때문이겠지?

일반적으로 유닉스나 리눅스 시스템에서 '.'이 의미하는 것은 숨김파일이라는 의미

more라는 명령어는  파일의 내용을 출력해주는 명령어중 하나(터미널 사이즈에 맞게 보여줌)

more /etc/profile : '모든사용자 환경설정 파일'에 대한 정보를 보여주세요~

export 한다는 의미는 현재 사용하고 있는 쉘의 환경설정을 다른 자식 쉘에게도 사용할 수 있게끔 해주겠다는 의미

more /etc/bashrc : '사용자 자원에 대한 환경설정 파일'

cd ~kiwi99는 kiwi99계정의 홈 디렉토리로 이동하겠다. '~' 틸드 기호

ls는 숨김 파일은 보여주지 않는 채로 현재 디렉토리에 파일명을 다 보여준다.

ls -al 은 모든 속성정보까지 보여준다.

ls -al | grep .bash : .bash라는 문자열을 포함하는 행만을 출력

echo는 문자열을 그대로 출력

ex.) echo hello => hello 출력

우리는 환경변수를 echo를 이용해서 출력해줄 수 있다.

환경변수를 참조하고 싶으면 $기호를 붙이면 됨

echo $SHELL : /bin/bash => 현재 내가 사용하고 있는 쉘은 bash라고 보여주고 있다. 

echo $USER : root  => 내가 사용하고 있는 계정이 root입니다.

echo $PATH : 실행파일 위치하고 있는 경로를 보여준다.

$PATH 환경변수는 무엇인가!!!?? 설명해봐!!!!

내가 현재 위치하고 있는 디렉토리에는 id라는게 없어? 근데 id를 치면 관련된 정보가 나와 이게 어떻게 가능할까? 바로 $PATH라는 환경변수 때문에 가능하다.

내가 어떤 실행파일을 입력하게 되면 PATH안에 미리 설정된 경로가 있다! 그러면 알아서 찾아줌 하지만 PATH에 경로설정이 안돼있다면 작동 ㄴㄴ

<hr>

/etc/passwd 파일 : 사용자 계정 정보를 담고있는 파일!!!, **구분자를 ':'으로 해서 7개의 필드로 구분된다**



1. user_account : 사용자 계정명
2. x : 사용자 패스워드 (x는 shadow 패스워드를 사용한다는 의미)
3. 0 : 사용자 ID(UID)
4. 0 : 기본 그룹 ID(GID)
5. root : comment
6. /root : home_directory
7. /bin/bash : login_shell



보안상의 이유로 passwd파일은 잘 사용되지 않는다. 실무에서는 shadow파일이 사용됨

shadow파일이란 것은 암호화된 패스워드를 담고 있는 파일이라고 이해하라 했지?

사람은 계정명으로 식별이 가능하지만 컴퓨터(시스템)은 ID를 통해서 식별한다.

그룹도 마찬가지!! 그룹 ID로 식별

user_ID => 0 은 root를 의미(root 계정)

group _ID => 0 은 root 그룹을 의미

유닉스/리눅스 시스템에서는 그룹은 2가지로 나눌 수 있다.

1.기본그룹(Primary Group)

2.보조그룹(Secondary Group)

이렇게 나누는 이유는 사용자 계정을 그룹단위로 관리하겠다라는 의미다!!!!

자원(파일 등)에 대한 접근권한, 보안설정을 그룹단위로 관리하겠다!!!!(효율성을 위해서)



정리하자면, 모든 사용자 계정은 디폴트로 기본그룹을 가지고 있다. 그런데 이때 필요에 의해서 보조그룹 등을 설정할 수 있습니다~

보조그룹은 어떤 권한이 필요했을 때 할당하는 그룹이라고 생각하고

기본그룹은 그룹으로서 권한은 가지고 있으며,추가적으로 자원을 생성할 때 그 자원의 소유그룹을 결정하는 그룹이라고 할 수 있다.



7번째 login_shell 부분은 무조건 login_shell 만 나오는건 아니다. 실행파일의 경로가 나올 수도 있다!!!

해커가 해킹을 시도 할때 주로 user_ID와 group_ID를 0으로 설정해놓고 한다.

사용자 계정이름이 root가 아니라고 하더라도 시스템은 그거와 상관없이 UID,GID가 0이면 root라고 생각하기 때문에!!!!

이는 윈도우의 보안식별자(SID) 500번이 관리자인것과 같은 개념~

그래서 일반적으로 보안취약점 점검할때 일반사용자의 UID,GID가 0으로 설정되있는지를 확인해야한다. 0으로 설정되어있다면 슈퍼계정이 되기때문에 조심~



cat이라는 명령어는 파일의 내용을 출력해줄 수 있는 명령어(여러가지 파일의 내용을 묶어서 출력해줄 수있는게 원래 목적, 그냥 한가지 파일만 출력해서 보여주게 할 수도 있음)

cat /etc/passwd : 다양한 계정정보를 볼 수 있음

vi : 텍스트 편집기



vi /etc/passwd를 통해서 내가 UID,GID를 바꿀 수 있음

텍스트 편집 후에 :wq를 입력하고 나가주면 됨~

7번째 로그인 쉘을 변경하여 사용자가 로그인시 악성 쉘이 실행되게 하는 경우도 있으므로 주기적으로 변경여부를 확인해야 한다.



그리고 짚고 넘어가야 할 것!!!

id algisa 이렇게 치면 나오는 uid와 gid 그리고 groups

여기서 gid는 기본그룹을 의미한다!!

기본그룹이 뭐라고? 파일(자원)을 생성할 때 소유그룹을 결정하는 것이 기본그룹이다.

모든 사용자는 최소 하나의 기본그룹을 갖는다!!!

그리고 groups는 기본그룹+보조그룹 => 해당 사용자가 가지고 있는 모든 그룹정보를 볼 수 있는 것



**패스워드 변경**

$ passwd : 자신의 패스워드를 바꾸는 것

$ passwd hacker : 슈퍼유저(root)가 사용자(hacker)의 패스워드를 바꿈



**그룹에 대한 정보**

more /etc/group : 그룹에 대한 계정 정보 볼 수 있음 

여기서 알고 넘어가야 할 것!!!

root : x : 0 : root 를 보자

여기서 root는 그룹명을 의미

x 는 '패스워드 사용 안함'이라는 의미!!!! (사용자 passwd에서는 x는 shadow 파일을 사용한다는 의미였잖아!!! 헷갈릴 수 있으니 조심) 옛날에는 그룹에도 패스워드를 사용했나봐ㅎㄷㄷ...

0은 group_ID가 root 라는 것이다

맨 마지막 root는 root그룹안에 들어있는 계정명들

**quiz.) bin : x : 1 : root,bin,daemon 을 설명해 봅시다.**

bin이라는 그룹명을 가졌고 패스워드는 사용안하고 group_ID는 1번을 사용하고 

bin그룹에는 root,bin,daemon이라는 계정들이 포함돼있다.















